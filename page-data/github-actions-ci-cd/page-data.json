{"componentChunkName":"component---src-templates-post-jsx","path":"/github-actions-ci-cd/","result":{"data":{"site":{"siteMetadata":{"title":"괜찮을지도"}},"markdownRemark":{"id":"b802f2fe-d332-504c-be84-fd7aa170c622","excerpt":"이 글은 우테코 괜찮을지도팀의 가 작성했습니다. 보다 편리하고 안정적인 개발 및 배포를 위해, 괜찮을지도 서비스에 CI/CD를 적용하였습니다. 이를 위한 도구로 GitHub Actions(self hosted runner)를 선택한 이유와, 파이프라인, 적용 방법에 대해 설명드리겠습니다. GitHub Actions를 사용한 이유 먼저 저희의 상황을 설명드…","html":"<blockquote>\n<p>이 글은 우테코 괜찮을지도팀의 <code class=\"language-text\">도이</code>가 작성했습니다.</p>\n</blockquote>\n<p>보다 편리하고 안정적인 개발 및 배포를 위해, 괜찮을지도 서비스에 CI/CD를 적용하였습니다.<br>\n이를 위한 도구로 GitHub Actions(self hosted runner)를 선택한 이유와, 파이프라인, 적용 방법에 대해 설명드리겠습니다.</p>\n<h2>GitHub Actions를 사용한 이유</h2>\n<p>먼저 저희의 상황을 설명드리자면,\n아래와 같은 제약 사항 안에서 개발 서버, 운영 서버의 분리가 필요했습니다.</p>\n<h3>제약 사항</h3>\n<ul>\n<li>EC2 최대 3개</li>\n<li>최대 t4g.small</li>\n<li>최대 20GiB</li>\n<li>매모리 2GiB</li>\n</ul>\n<p>운영 서버에서 사용하는 DB는 서버 분리가 필요하다고 판단해, 세 대의 인스턴스를 각각 아래 그림과 같이 개발, 운영, 운영 DB 서버로 분담했습니다.<br>\n그리고 이 제약 사항 안에서 알뜰하게 서버를 사용하고 트러블 슈팅하는 것을 저희의 기술적 도전으로 삼고자 합니다.</p>\n<h3>인프라 구조</h3>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/87e65d80fb642a2a2d8b157bf2909454/aaf92/infra.jpg' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lAH/8QAFhAAAwAAAAAAAAAAAAAAAAAAACBB/9oACAEBAAEFAip//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRAAAgMBAAAAAAAAAAAAAAAAABEBECFR/9oACAEBAAE/Ic1Iiijgq//aAAwDAQACAAMAAAAQA8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEBAQEAAwAAAAAAAAAAAAABEQAxECFB/9oACAEBAAE/ECeJezVViTDfiYKwFaw7gV9d8f/Z'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='infra' title='' src='/static/87e65d80fb642a2a2d8b157bf2909454/a22ce/infra.jpg' srcset='/static/87e65d80fb642a2a2d8b157bf2909454/0b705/infra.jpg 170w,\n/static/87e65d80fb642a2a2d8b157bf2909454/31389/infra.jpg 340w,\n/static/87e65d80fb642a2a2d8b157bf2909454/a22ce/infra.jpg 680w,\n/static/87e65d80fb642a2a2d8b157bf2909454/29373/infra.jpg 1020w,\n/static/87e65d80fb642a2a2d8b157bf2909454/232dc/infra.jpg 1360w,\n/static/87e65d80fb642a2a2d8b157bf2909454/aaf92/infra.jpg 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>팀원들 모두가 CI/CD에 능숙하지 않은 상황에서 상대적으로 대중적이고 관련 자료를 쉽게 접할 수 있는 기술을 생각했을 때,<br>\nJenkins와 GitHub Actions가 고려 대상이었습니다.</p>\n<p>아래와 같은 이유로, 둘 중 GitHub Actions를 사용해 최대한 간단하게 CI/CD를 구축하는 것이 적합하다고 판단했습니다.  </p>\n<ol>\n<li>\n<p>메모리 부담 최소화</p>\n<ul>\n<li>Jenkins를 사용하면, EC2에서 빌드 및 테스트를 수행해야 합니다.</li>\n<li>반면, GitHub Actions는 GitHub Artifact에 업로드한 빌드 결과물을 EC2에서 다운로드하면 됩니다.</li>\n<li>실제로 한 팀원이 EC2 t2g.micro에 젠킨스 CI/CD를 적용했다가, 메모리가 부족해 서버가 죽는 과거의 경험을 공유해주었습니다.</li>\n<li>때문에 적어도 CI 만큼은 GitHub Actions로 분리해 테스트 실행을 외부 서비스에 위임하기로 했습니다.</li>\n<li>\n<p>하지만 그렇다면, 간결한 파이프라인을 위해 CI/CD를 모두 GitHub Actions로 통합하는 것이 좋다고 판단했습니다.</p>\n<blockquote>\n<p>EC2에서 <code class=\"language-text\">./gradlew build</code>를 수행해 직접 빌드 및 테스트를 할 경우 아래와 같이 총 26.2%의 사용량이 확인되지만,<br>\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/3e3b041ba86d85b4ba5b6adb3ab991ab/ca756/ec2-build-usage.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 39.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABoElEQVR42k2R2U7CUBCG+xJIvGWnLWWpUNqytGUTmlCgxHfwQhI3BKNeCHqhRo0RfdzfmRMgXvw5kzNz/vlmjvS9vMb7/BybuwU+by6xuV/i5+EWvySOP+ju63aOl/MZvrlmcYXns1O8Xszw9rTG43qN9Var1QqSU6vhJJxAz2uwq4bQ0B+gYVvouC56rRYMXUfdMtFqNhGOArRdB1o2i8NoFNF/ihxEIOn6EYJgBKNahUMGHhkMg2AfsxqNJlzXw2DgYxKGGE8mMC0LqXQasiwjS+Y7SfF4HJ1OB2lKNomgXC5DVRQopHw+j1KpBNuuoV6v47jXw3Q6Rb/fJ/OBMEgkEkKpVArJZBISBy7RZDIZ1Gh8wzCQy+WgqioKhYIwrVQq4p4bBkTf7XZFzM3YVNM08V4YyrKCdrstEkzBhFygbA1LtL+qacKiET3Pw3g8FoZM6DgO0dswKb83ZBIegU8mZZNisSgomYDJeIeO44o6HrlHo4e0SwbhJlzHq9sSyiKhKKp4zHQ85o5QZ0L6sB2h7/uCkE+uj8ViYn+7Hf4BLR8XxB5LO8UAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='ec2-build-usage.png' title='' src='/static/3e3b041ba86d85b4ba5b6adb3ab991ab/ca1dc/ec2-build-usage.png' srcset='/static/3e3b041ba86d85b4ba5b6adb3ab991ab/e7570/ec2-build-usage.png 170w,\n/static/3e3b041ba86d85b4ba5b6adb3ab991ab/f46e7/ec2-build-usage.png 340w,\n/static/3e3b041ba86d85b4ba5b6adb3ab991ab/ca1dc/ec2-build-usage.png 680w,\n/static/3e3b041ba86d85b4ba5b6adb3ab991ab/02d09/ec2-build-usage.png 1020w,\n/static/3e3b041ba86d85b4ba5b6adb3ab991ab/ca756/ec2-build-usage.png 1296w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>ec2-build-usage.png</figcaption>\n  </figure>\n그 대신 Actions Runner가 가동하는 상황을 확인해본 결과, 전체 메모리의 최대 11.9%만을 사용함을 알 수 있었습니다.<br>\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/da18fd4f83fb28e329badab6f664e0ab/41396/actions-runner-usage.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 22.352941176470587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAYAAACOXx+WAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEklEQVR42h2QXWuCABSG/RvrojUI+hBGGUQt01omZjS6aBeDxjZYNTO/yiw3lS7638+ki8N7Hng4HF5htVoTRRGbr0+S6MjlN+YSx/wdQ/b2lux8Ij1FhK7D0XNxfzbYq2/8rcV5H+Bs1ux323xs1vktodlsMp1MkOtVFuMRH/MZr7rGTJHp1ivMhwpvpsG038XsdWhXyvQfRbR2i4U+unkvqkyvWua+WEQQRRFd16nXajx1OpgTg4Gq8jwc0s1Z7vUYaxotSUJVFKRG4+Z22m1Mw2A4UJHypx5KJe4KBYTdbkeSJARBgOd5pGmGn+9plnE4hIRhyOkc3/h6vWLnvmVZ+L5PnFfj5blcvuO4Lo7j8A8rfZ//YZfDmwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='actions-runner-usage.png' title='' src='/static/da18fd4f83fb28e329badab6f664e0ab/ca1dc/actions-runner-usage.png' srcset='/static/da18fd4f83fb28e329badab6f664e0ab/e7570/actions-runner-usage.png 170w,\n/static/da18fd4f83fb28e329badab6f664e0ab/f46e7/actions-runner-usage.png 340w,\n/static/da18fd4f83fb28e329badab6f664e0ab/ca1dc/actions-runner-usage.png 680w,\n/static/da18fd4f83fb28e329badab6f664e0ab/02d09/actions-runner-usage.png 1020w,\n/static/da18fd4f83fb28e329badab6f664e0ab/9d567/actions-runner-usage.png 1360w,\n/static/da18fd4f83fb28e329badab6f664e0ab/41396/actions-runner-usage.png 1610w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>actions-runner-usage.png</figcaption>\n  </figure></p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li>\n<p>쉽고 빠른 적용 </p>\n<ul>\n<li>GitHub 레포지토리에서 바로 설정이 가능해 기존 개발 환경과 통합해 사용 가능합니다.</li>\n<li>YAML 파일 작성만으로도 쉽고 빠른 적용이 가능합니다.</li>\n<li>GitHub가 Runner를 관리해주기 때문에, 서버 관리 부담이 덜합니다.</li>\n</ul>\n</li>\n</ol>\n<h2>CI/CD 파이프라인</h2>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/7a8df2a639dab8236f0b2622d706c43a/aaf92/cicd-pipeline.jpg' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3ZQmP//EABgQAAIDAAAAAAAAAAAAAAAAAAABEDFB/9oACAEBAAEFAtTFU//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAIDAQEAAAAAAAAAAAAAAAERACExEMH/2gAIAQEAAT8hylexoBRDhNm4NPf/2gAMAwEAAgADAAAAEHDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAQEAAgMAAAAAAAAAAAAAAREAECExQXH/2gAIAQEAAT8Q6JHZiB5YJ2NiRPuIBBrXEFPbXgAIEN//2Q=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='cicd pipeline' title='' src='/static/7a8df2a639dab8236f0b2622d706c43a/a22ce/cicd-pipeline.jpg' srcset='/static/7a8df2a639dab8236f0b2622d706c43a/0b705/cicd-pipeline.jpg 170w,\n/static/7a8df2a639dab8236f0b2622d706c43a/31389/cicd-pipeline.jpg 340w,\n/static/7a8df2a639dab8236f0b2622d706c43a/a22ce/cicd-pipeline.jpg 680w,\n/static/7a8df2a639dab8236f0b2622d706c43a/29373/cicd-pipeline.jpg 1020w,\n/static/7a8df2a639dab8236f0b2622d706c43a/232dc/cicd-pipeline.jpg 1360w,\n/static/7a8df2a639dab8236f0b2622d706c43a/aaf92/cicd-pipeline.jpg 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\nCI/CD 파이프라인은 다음과 같습니다.  </p>\n<ol>\n<li>Pull Request의 생성 또는 업데이트, Pull Request에 대한 Merge가 발생합니다.</li>\n<li>이벤트에 트리거된 <code class=\"language-text\">GitHub Actions workflow</code>가 실행됩니다.</li>\n<li>\n<p><code class=\"language-text\">workflow</code>에 작성한 내용에 의해, <code class=\"language-text\">GitHub hosting Runner</code>가 빌드 및 테스트를 수행합니다.</p>\n<ul>\n<li>이 때, 테스트 결과를 PR 코멘트로 등록해줍니다.</li>\n<li><code class=\"language-text\">Pull Request의 생성 또는 업데이트에 대한 workflow</code>의 경우 이 단계까지만 수행합니다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">Pull request Merge에 대한 workflow</code>의 경우, 빌드한 결과물을 GitHub의 자체 저장소인 <code class=\"language-text\">Artifact Storage</code>에 업로드합니다.</li>\n<li>우리의 <code class=\"language-text\">EC2</code>에 설치된 <code class=\"language-text\">Self Hosted Runner</code>가 4번의 결과물을 다운로드 받습니다.</li>\n<li><code class=\"language-text\">Self Hosted Runner</code>가 배포 스크립트를 실행하게 하여, 필요한 어플리케이션을 실행하고 정적 파일을 적절한 위치에 배치합니다.</li>\n</ol>\n<p>2번부터 6번까지, 모두 하나의 workflow 내에서 벌어지는 일입니다.</p>\n<h2>적용 방법</h2>\n<h3>GitHub Actions workflow</h3>\n<p><code class=\"language-text\">workflow</code>란 하나 이상의 작업을 실행하는, 자동화된 프로세스입니다.<br>\n레포지토리의 <code class=\"language-text\">.github/workflows</code> 디렉토리에 YAML 파일을 저장해 <code class=\"language-text\">workflow</code> 를 정의할 수 있습니다.\n하나의 레포지토리는 여러 개의 <code class=\"language-text\">workflow</code>를 가질 수 있습니다.</p>\n<p>괜찮을지도 서비스에서는</p>\n<ol>\n<li><code class=\"language-text\">pull request</code>에 대한 빌드 및 테스트만 수행하는 상황 vs <code class=\"language-text\">pull request merge</code> 시 배포까지 수행하는 상황</li>\n<li>대상이 <code class=\"language-text\">main</code> 브랜치 vs <code class=\"language-text\">dev</code> 브랜치</li>\n<li>대상이 프론트엔드 / 백엔드</li>\n</ol>\n<p>세 가지 상황을 고려하여 여러 개의 <code class=\"language-text\">workflow</code>를 작성했습니다.  </p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/bf42bd6f3c4972bedd4c3962661f345e/aaf92/workflows-dev.jpg' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHdW2CwB//EABgQAQADAQAAAAAAAAAAAAAAAAEAAhEQ/9oACAEBAAEFAlyFq7Hv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFxAAAwEAAAAAAAAAAAAAAAAAAAIhIP/aAAgBAQAGPwKkbP8A/8QAGxABAAICAwAAAAAAAAAAAAAAAQARECFBUdH/2gAIAQEAAT8hM2gO2KoKvFzeHuP/2gAMAwEAAgADAAAAEEDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAgIDAQAAAAAAAAAAAAAAAREAIRAxkUH/2gAIAQEAAT8QuX6YgIGVOAPyClkTbZ7Emnt7j//Z'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='workflows dev' title='' src='/static/bf42bd6f3c4972bedd4c3962661f345e/a22ce/workflows-dev.jpg' srcset='/static/bf42bd6f3c4972bedd4c3962661f345e/0b705/workflows-dev.jpg 170w,\n/static/bf42bd6f3c4972bedd4c3962661f345e/31389/workflows-dev.jpg 340w,\n/static/bf42bd6f3c4972bedd4c3962661f345e/a22ce/workflows-dev.jpg 680w,\n/static/bf42bd6f3c4972bedd4c3962661f345e/29373/workflows-dev.jpg 1020w,\n/static/bf42bd6f3c4972bedd4c3962661f345e/232dc/workflows-dev.jpg 1360w,\n/static/bf42bd6f3c4972bedd4c3962661f345e/aaf92/workflows-dev.jpg 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/7b25b45d7feddcba30970fd1c6a9cb32/aaf92/workflows-prod.jpg' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 56.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMBAgX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHdW2CwB//EABgQAQADAQAAAAAAAAAAAAAAAAEAAhEQ/9oACAEBAAEFAlyFq7Hv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAACECESD/2gAIAQEABj8CYpXn/8QAGxABAAICAwAAAAAAAAAAAAAAAQARECFBUdH/2gAIAQEAAT8hM2gO2KoKeLm8Pcf/2gAMAwEAAgADAAAAEEDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxAAAgIDAQAAAAAAAAAAAAAAAREAMRAhkUH/2gAIAQEAAT8Q3L9MQEDNCgD8g0sS1nsSadvcf//Z'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='workflows prod' title='' src='/static/7b25b45d7feddcba30970fd1c6a9cb32/a22ce/workflows-prod.jpg' srcset='/static/7b25b45d7feddcba30970fd1c6a9cb32/0b705/workflows-prod.jpg 170w,\n/static/7b25b45d7feddcba30970fd1c6a9cb32/31389/workflows-prod.jpg 340w,\n/static/7b25b45d7feddcba30970fd1c6a9cb32/a22ce/workflows-prod.jpg 680w,\n/static/7b25b45d7feddcba30970fd1c6a9cb32/29373/workflows-prod.jpg 1020w,\n/static/7b25b45d7feddcba30970fd1c6a9cb32/232dc/workflows-prod.jpg 1360w,\n/static/7b25b45d7feddcba30970fd1c6a9cb32/aaf92/workflows-prod.jpg 1920w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h3>workflow 만들기</h3>\n<p><code class=\"language-text\">workflow</code>는 기본적으로 아래와 같은 요소들을 가져야 합니다.</p>\n<ol>\n<li><code class=\"language-text\">workflow</code>를 유발시킬 하나 이상의 이벤트 : <code class=\"language-text\">on</code></li>\n<li><code class=\"language-text\">workflow</code>에서 수행할 하나 이상의 작업: <code class=\"language-text\">job</code></li>\n<li><code class=\"language-text\">job</code> 블록 내에 단계 별 스크립트 또는 익스텐션 실행을 정의: <code class=\"language-text\">step</code></li>\n</ol>\n<p>여기서 주의할 점은, 여러개의 <code class=\"language-text\">job</code>은 기본적으로 병렬적으로 처리된다는 것입니다.<br>\n순차적으로 실행하고 싶다면, <code class=\"language-text\">needs</code> 블록을 사용해야 합니다.  </p>\n<p>아래는 현재 적용된 workflow입니다. 이해를 돕기 위해 주석을 추가하였습니다.  </p>\n<h3>백엔드 CI workflow</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Backend CI For Test Validation\n\n<span class=\"token comment\"># 트리거 설정</span>\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\n  \n  <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> main<span class=\"token punctuation\">,</span> develop <span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span> backend/<span class=\"token important\">**</span> <span class=\"token comment\"># 해당 디렉토리 내 파일의 변경이 있을 때만 트리거됨</span>\n\n<span class=\"token comment\"># 테스트 결과 등록을 위한 권한 설정</span>\n<span class=\"token key atrule\">permissions</span><span class=\"token punctuation\">:</span> \n  <span class=\"token key atrule\">pull-requests</span><span class=\"token punctuation\">:</span> write\n  <span class=\"token key atrule\">checks</span><span class=\"token punctuation\">:</span> write\n  <span class=\"token key atrule\">contents</span><span class=\"token punctuation\">:</span> write\n  \n<span class=\"token comment\"># 수행할 작업들</span>\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build-and-comment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 해당 job을 실행할 환경 설정</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span><span class=\"token number\">22.04</span>\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up JDK 17\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>java@v3\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">java-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'17'</span>\n        <span class=\"token key atrule\">distribution</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'temurin'</span>\n        \n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gradlew 실행 권한 부여\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> chmod +x gradlew\n      <span class=\"token key atrule\">working-directory</span><span class=\"token punctuation\">:</span> backend\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Gradle build 시작\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> ./gradlew clean build\n      <span class=\"token key atrule\">working-directory</span><span class=\"token punctuation\">:</span> backend\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> 테스트 결과를 PR에 코멘트로 등록합니다\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> EnricoMi/publish<span class=\"token punctuation\">-</span>unit<span class=\"token punctuation\">-</span>test<span class=\"token punctuation\">-</span>result<span class=\"token punctuation\">-</span>action@v1\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> always()\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">files</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'backend/build/test-results/test/TEST-*.xml'</span>\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> 테스트 실패 시<span class=\"token punctuation\">,</span> 실패한 코드 라인에 Check 코멘트를 등록합니다\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> mikepenz/action<span class=\"token punctuation\">-</span>junit<span class=\"token punctuation\">-</span>report@v3\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> always()\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">report_paths</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'**/build/test-results/test/TEST-*.xml'</span>\n        <span class=\"token key atrule\">token</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> github.token <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<h3>백엔드 CD workflow</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Backend develop CI/CD\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\n  \n  <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n     <span class=\"token comment\"># 배포 설정은 main, develop 브랜치 별로 다르게 트리거</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> develop <span class=\"token punctuation\">]</span>\n     <span class=\"token comment\"># 브랜치가 닫힐 때만 트리거</span>\n    <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>closed<span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span> backend/<span class=\"token important\">**</span>\n\n<span class=\"token key atrule\">permissions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">contents</span><span class=\"token punctuation\">:</span> read\n  \n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build-and-upload</span><span class=\"token punctuation\">:</span>    \n    <span class=\"token comment\"># Pull Request를 그냥 닫은 게 아니라, merge해서 닫았을 때만 실행</span>\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> github.event.pull_request.merged\n    \n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span><span class=\"token number\">22.04</span>\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up JDK 17\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>java@v3\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">java-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'17'</span>\n        <span class=\"token key atrule\">distribution</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'temurin'</span>\n        \n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> gradlew 실행 권한 부여\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> chmod +x gradlew\n      <span class=\"token key atrule\">working-directory</span><span class=\"token punctuation\">:</span> backend\n\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Gradle build 시작\n      <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> ./gradlew clean build\n      <span class=\"token key atrule\">working-directory</span><span class=\"token punctuation\">:</span> backend\n        \n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> jar 파일 artifact에 업로드\n      <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/upload<span class=\"token punctuation\">-</span>artifact@v3\n      <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n        <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> BackendApplication\n        <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> backend/build/libs/mapbefine.jar\n\n  <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n     <span class=\"token comment\"># Pull Request를 그냥 닫은 게 아니라, merge해서 닫았을 때만 실행</span>\n     <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> github.event.pull_request.merged\n\n     <span class=\"token comment\"># deploy는 build-and-upload 작업과 달리 self-hosted runner를 사용</span>\n     <span class=\"token comment\"># main, develop 브랜치마다 각각 운영 서버, 개발 서버의 runner만을 실행하도록 해야 함</span>\n     <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> self<span class=\"token punctuation\">-</span>hosted<span class=\"token punctuation\">,</span> dev <span class=\"token punctuation\">]</span>를\n     <span class=\"token comment\"># build-and-upload 작업이 성공적으로 완료될 경우 실행</span>\n     <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> build<span class=\"token punctuation\">-</span>and<span class=\"token punctuation\">-</span>upload\n  \n     <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> 구버전 jar 파일 삭제\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> rm <span class=\"token punctuation\">-</span>rf /home/ubuntu/backend/build/<span class=\"token important\">*.jar</span> \n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> jar파일 artifact에서 다운로드\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/download<span class=\"token punctuation\">-</span>artifact@v3 \n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> BackendApplication\n          <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /home/ubuntu/backend/build/\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> 배포하기\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> /home/ubuntu/backend/deploy.sh\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> 슬랙 메시지 보내기\n\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> 8398a7/action<span class=\"token punctuation\">-</span>slack@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">mention</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'here'</span>\n          <span class=\"token key atrule\">if_mention</span><span class=\"token punctuation\">:</span> always\n          <span class=\"token key atrule\">status</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> job.status <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">fields</span><span class=\"token punctuation\">:</span> workflow<span class=\"token punctuation\">,</span>job<span class=\"token punctuation\">,</span>commit<span class=\"token punctuation\">,</span>message<span class=\"token punctuation\">,</span>ref<span class=\"token punctuation\">,</span>author<span class=\"token punctuation\">,</span>took\n        <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">SLACK_WEBHOOK_URL</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SLACK_WEBHOOK_URL <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n        <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> always()</code></pre></div>\n<h3>프론트엔드 CI workflow</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Frontend CI For Test Validation\n<span class=\"token comment\"># 어떤 이벤트가 발생하면 실행할지 결정</span>\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token comment\">#pull request open과 reopen 시 실행한다.</span>\n  <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>main<span class=\"token punctuation\">,</span> develop<span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span> frontend/<span class=\"token important\">**</span>\n<span class=\"token key atrule\">defaults</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">working-directory</span><span class=\"token punctuation\">:</span> ./frontend\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">jest</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span><span class=\"token number\">22.04</span>\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout repository\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v2\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Setup Node.js\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v2\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"18\"</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install node modules\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm install\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Run Jest test\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run test</code></pre></div>\n<h3>프론트엔드 CD workflow</h3>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Frontend develop CD\n\n<span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span>\n\n  <span class=\"token key atrule\">pull_request</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">branches</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> develop <span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">types</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> closed <span class=\"token punctuation\">]</span>\n    <span class=\"token key atrule\">paths</span><span class=\"token punctuation\">:</span> frontend/<span class=\"token important\">**</span>\n\n<span class=\"token key atrule\">permissions</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">contents</span><span class=\"token punctuation\">:</span> read\n\n<span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">build-and-upload</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> github.event.pull_request.merged\n\n    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span><span class=\"token number\">22.04</span>\n\n    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v3\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Set up Node.js 18\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/setup<span class=\"token punctuation\">-</span>node@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">node-version</span><span class=\"token punctuation\">:</span> <span class=\"token number\">18</span>\n          <span class=\"token key atrule\">cache</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"npm\"</span>\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Install npm\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm install <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>force\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> grant excute access\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> chmod +x npm\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Build project\n        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> npm run build\n\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> upload to artifact\n        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/upload<span class=\"token punctuation\">-</span>artifact@v3\n        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n          <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> FrontendApplication\n          <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> frontend/dist\n\n  <span class=\"token key atrule\">deploy</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> self<span class=\"token punctuation\">-</span>hosted<span class=\"token punctuation\">,</span> dev <span class=\"token punctuation\">]</span>\n      <span class=\"token key atrule\">needs</span><span class=\"token punctuation\">:</span> build<span class=\"token punctuation\">-</span>and<span class=\"token punctuation\">-</span>upload\n\n      <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> github.event.pull_request.merged\n\n      <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> delete old js file\n          <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> rm <span class=\"token punctuation\">-</span>rf /home/ubuntu/frontend/dist\n\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> download js file from artifact\n          <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/download<span class=\"token punctuation\">-</span>artifact@v3\n          <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> FrontendApplication\n            <span class=\"token key atrule\">path</span><span class=\"token punctuation\">:</span> /home/ubuntu/frontend\n\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> deploy\n          <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> /home/ubuntu/frontend/deploy.sh\n\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> send slack message\n\n          <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> 8398a7/action<span class=\"token punctuation\">-</span>slack@v3\n          <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">mention</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'here'</span>\n            <span class=\"token key atrule\">if_mention</span><span class=\"token punctuation\">:</span> always\n            <span class=\"token key atrule\">status</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> job.status <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n            <span class=\"token key atrule\">fields</span><span class=\"token punctuation\">:</span> workflow<span class=\"token punctuation\">,</span>job<span class=\"token punctuation\">,</span>commit<span class=\"token punctuation\">,</span>message<span class=\"token punctuation\">,</span>ref<span class=\"token punctuation\">,</span>author<span class=\"token punctuation\">,</span>took\n          <span class=\"token key atrule\">env</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">SLACK_WEBHOOK_URL</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.SLACK_WEBHOOK_URL <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\n          <span class=\"token key atrule\">if</span><span class=\"token punctuation\">:</span> always()</code></pre></div>\n<h2>Self-hosted Runner</h2>\n<p>앞서 말씀드린 파이프라인 대로 배포를 하기 위해서는, 배포를 할 서버에 <code class=\"language-text\">GitHub Actions</code>의 <code class=\"language-text\">Self-hosted Runner</code>를 설치해야 합니다.  </p>\n<p>앞서 설명드린 <code class=\"language-text\">workflow</code>는 GitHub에서 호스팅하는 Runner가 수행할 수도 있지만,<br>\n원하는 서버에 자체적으로 Runner를 호스팅하여 사용할 수도 있습니다.</p>\n<p>workflow의 <code class=\"language-text\">runs-on</code> 블록에서 어떤 Runner를 통해 작업을 수행할지 정의합니다.</p>\n<h3>EC2에 Self-hosted Runner 띄우기</h3>\n<h4>1. 다운로드</h4>\n<p>레포지토리의 <code class=\"language-text\">Settings</code> - <code class=\"language-text\">Actions</code> - <code class=\"language-text\">Runners</code>에 들어가면 <code class=\"language-text\">New self-hosted runner</code> 버튼이 있습니다.<br>\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/24564f825750ff54f3a9c51f8ffb805b/d621b/create-runner.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABC0lEQVR42qVS2U7DQAzs//8Or/xDJQ7BGxIliByk2e6dPaa2Q1pAPJGRrF35GI+9u3MhwlgHTcan9UHO8TjBeQ+Os8+xX2t48pVc0PQNHg9PeB8a5DkhpoyZbAdCiFRkLVaknPHRf+JkPMVmSkxiiY1iiZrcv9zhZn+Lh9dnqalftUIYKaFtOzjnxFlKhZ8rbKBiUhMDK3SimBvPpOiKiu9YCEnhcZqIqFxS1rSQKrrRoB0U+mFE23XQ2iBTbqnlUvODkPdijLn2rJUMYoXvv3Ss8b8ghM5HTJOSUXMq0v2/EEJtLA5vjexmGaVuI+RlK6VklK1Yvg29slInIeavsZnQ06ft+l5eb6vKM30SExSjfMg1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='create-runner.png' title='' src='/static/24564f825750ff54f3a9c51f8ffb805b/ca1dc/create-runner.png' srcset='/static/24564f825750ff54f3a9c51f8ffb805b/e7570/create-runner.png 170w,\n/static/24564f825750ff54f3a9c51f8ffb805b/f46e7/create-runner.png 340w,\n/static/24564f825750ff54f3a9c51f8ffb805b/ca1dc/create-runner.png 680w,\n/static/24564f825750ff54f3a9c51f8ffb805b/02d09/create-runner.png 1020w,\n/static/24564f825750ff54f3a9c51f8ffb805b/9d567/create-runner.png 1360w,\n/static/24564f825750ff54f3a9c51f8ffb805b/d621b/create-runner.png 1439w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>create-runner.png</figcaption>\n  </figure>\n버튼을 누르면 아래와 같은 설정 페이지로 접속하는데, Runner를 띄울 서버 환경에 맞는 설정을 선택해줍니다.<br>\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/64b8788e7ab4312363528c8e98b26d58/722fb/architecture-runner.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 51.17647058823529%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeElEQVR42n1Ta5ODIAzs//+TN3e9+hYpAlJB97KpfX05ZnZUSJbNJp7ikmCvM2YfEeTdzR4uJPRTgJmuGCeLYTQw9ooQk4I5RPABTvbTLSOXHdY6nLZtQ4wR+74ruELK6G3EOAzoe8Fwx7JErOuqBLdVcFvB/McKIeBUSoExE0ZjhHjRA+s8vs41qs7iUrdomhbOOYkzEieKrai/yoXWY83lk3DbdkxSlnPzU+Eqt9MGBnOLMUWUPM75zDmrOm49K7sTbkpY3qRzz80zUkr6TX/oHUmYy6ooYJHzHS9C7/295FFMf/eCjWnb7kjehKg8k/5bvFAJ66ZRuY/Fm9lVGs+yFRJXjtIzUV54t+JUtDyvKvJhMJ9V22tD6m7ApekwyAg5v8BL6cTMEVpuMhHS6YOQVaqHXd9/dDnJaJwvjYLElRASdTso8XiA0xDfCFUh54pjw5LpgRLKfP1canz/Vqqy7UexYFYCI8M7yQQ4+RH47UXlg5D2/QH2dAmr1rh9agAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='architecture-runner.png' title='' src='/static/64b8788e7ab4312363528c8e98b26d58/ca1dc/architecture-runner.png' srcset='/static/64b8788e7ab4312363528c8e98b26d58/e7570/architecture-runner.png 170w,\n/static/64b8788e7ab4312363528c8e98b26d58/f46e7/architecture-runner.png 340w,\n/static/64b8788e7ab4312363528c8e98b26d58/ca1dc/architecture-runner.png 680w,\n/static/64b8788e7ab4312363528c8e98b26d58/02d09/architecture-runner.png 1020w,\n/static/64b8788e7ab4312363528c8e98b26d58/9d567/architecture-runner.png 1360w,\n/static/64b8788e7ab4312363528c8e98b26d58/722fb/architecture-runner.png 1465w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>architecture-runner.png</figcaption>\n  </figure>\n해당 환경의 터미널에서 runner package를 다운로드합니다. 선택한 설정에 맞게 제공된 커맨드를 복사해 실행하면 됩니다.<br>\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/e179cbebe9b0269f6f728b54f6b7f512/d621b/download-runner.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVR42o2Ta4rcMBCE9/6HCGQh5AqBkFMElvxM2Ox4xpYfsvV+uLbUMxNm2SFJQ1lGsj5Xd0sPYGzGQGuNa+Sc0Z96xJhQckFOGXutwL7f1008tIexFicCatvEKClBK4UcAmqMop1zTTXFs2SOiuENVICWwOZwvyzs4nDAUU1Qs8YwLVhWAxsSXMw3KojeAxcjf4DOeQFa55BLkQ+6lw6/fh9wOPYU4ScFRbDerMCbjI/3gd4HqHGS1MUhoV13xM/nA55fjuh6hWFczm7HGeO8YlpWLJtDdHeAzdk4zdKMFpXj2PcYuXnivG6bCTPGys9FLjCzgMS974CJXdw2wzGdgXQ40OFM17MaoRu0aV7geCI8M2mpJoJLTO+7fBvXxnz5+g0fPj7i8dNnfH/6gdV6THpjmmygcVI/wyaFVP4OFIdModV0oLuFkFwqStmpKu+ZZzNd1Ob+CWwuZ4JaA6SbrNVqHVyICDwuV/mQBfpfwFbTdd04WrlJTeu28SQ4WTMsgXZ0WN/elFeo6FfQ1tbFBAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='download-runner.png' title='' src='/static/e179cbebe9b0269f6f728b54f6b7f512/ca1dc/download-runner.png' srcset='/static/e179cbebe9b0269f6f728b54f6b7f512/e7570/download-runner.png 170w,\n/static/e179cbebe9b0269f6f728b54f6b7f512/f46e7/download-runner.png 340w,\n/static/e179cbebe9b0269f6f728b54f6b7f512/ca1dc/download-runner.png 680w,\n/static/e179cbebe9b0269f6f728b54f6b7f512/02d09/download-runner.png 1020w,\n/static/e179cbebe9b0269f6f728b54f6b7f512/9d567/download-runner.png 1360w,\n/static/e179cbebe9b0269f6f728b54f6b7f512/d621b/download-runner.png 1439w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>download-runner.png</figcaption>\n  </figure>   </p>\n<p>아래는 Linux, ARM64 환경의 runner를 다운로드받기 위한 스크립트입니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># Create a folder</span>\n$ <span class=\"token function\">mkdir</span> actions-runner <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> actions-runner\n<span class=\"token comment\"># Download the latest runner package</span>\n$ <span class=\"token function\">curl</span> <span class=\"token parameter variable\">-o</span> actions-runner-linux-arm64-2.307.1.tar.gz <span class=\"token parameter variable\">-L</span> https://github.com/actions/runner/releases/download/v2.307.1/actions-runner-linux-arm64-2.307.1.tar.gz\n<span class=\"token comment\"># Optional: Validate the hash</span>\n$ <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"01edc84342ef4128a8f19bc2f33709b40f2f1c40e250e2a4c5e0adf620044ab3  actions-runner-linux-arm64-2.307.1.tar.gz\"</span> <span class=\"token operator\">|</span> shasum <span class=\"token parameter variable\">-a</span> <span class=\"token number\">256</span> <span class=\"token parameter variable\">-c</span>\n<span class=\"token comment\"># Extract the installer</span>\n$ <span class=\"token function\">tar</span> xzf ./actions-runner-linux-arm64-2.307.1.tar.gz</code></pre></div>\n<h4>2. Runner 생성 및 설정</h4>\n<p>마찬가지로 제공된 스크립트에 따라, runner를 생성하고 설정합니다.<br>\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/c60bf6833f878124f1a20547fc2900a9/d621b/configure-runner.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABhUlEQVR42o2T60rsMBSFff+HEI4i5xUE8SkEwX/n4GVq06ZNc22azHIltTIyRdywmjaZ+bL2zs4FGNoYKKWwxZISWiEwLxEp5/p9PB7xm7goD2Mt3t9bZP65REoZatIEZWSCio6fyifa5s6AlsDicFssY9tLNG2HTo4QcsA4Gdgww4W4al7HOaZzoHO+Aq1zNb0Sh0bg/8sb3pqWEit8UFDaEm7rBsYFlmUH6H1AR0cldfpD8Xkg4N/zK55fm/ou+rECy9gPE+SoK3iOy07KdNYzrWVZFzNd9tygSHJejRNGwoyxdfNNjg4jUz8DRu6iteG4LmbvIQ4Nhr7H0PVQUq4aBjh2hGcmM38TCU2OWX0e5hfwNOrBULd397j8c42rm794eHzCZAOkMhi1gzIOxkeYkBDo8kdgdTizpnQomgYjHS50k0KoKu9FkWUqShROWmcXWFwOrJvo5NdpTnTl/IzAmm3ybJu4d8p7wFLTSWveIltvUhknzhnr6pqxbDWXeJO+N/YHaNxYBOj1FvYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='configure-runner.png' title='' src='/static/c60bf6833f878124f1a20547fc2900a9/ca1dc/configure-runner.png' srcset='/static/c60bf6833f878124f1a20547fc2900a9/e7570/configure-runner.png 170w,\n/static/c60bf6833f878124f1a20547fc2900a9/f46e7/configure-runner.png 340w,\n/static/c60bf6833f878124f1a20547fc2900a9/ca1dc/configure-runner.png 680w,\n/static/c60bf6833f878124f1a20547fc2900a9/02d09/configure-runner.png 1020w,\n/static/c60bf6833f878124f1a20547fc2900a9/9d567/configure-runner.png 1360w,\n/static/c60bf6833f878124f1a20547fc2900a9/d621b/configure-runner.png 1439w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>configure-runner.png</figcaption>\n  </figure>\n먼저 아래 커맨드를 실행하면, 아래와 같이 Runner 환경 설정을 위해 몇 가지를 입력해야 합니다.  </p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ ./config.sh <span class=\"token parameter variable\">--url</span> <span class=\"token variable\">${repository URL}</span> <span class=\"token parameter variable\">--token</span> <span class=\"token variable\">${runner 생성 페이지에서 제공된 토큰}</span></code></pre></div>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/6fedd99483492e0a4fda63fa9cc0365f/911ab/runner-registration.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 81.76470588235294%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVR42o1UabKGIAzzdo4bqGxu7/7H4DVIHPXTGX9kWqQNKS0WWusI9H0f6Sulku267rKmj+/81jTNBQU3QwjRGJMA8lEsDxqGIRpro/c++eM4Hge+EpLMSPAoJLBGkgdJdPLdZUIrFgDpIyHI4LSy2cKirG2Lal1jtyyxmyZZ/4m/phgmtm37TogNAmslChM0oLMvJWIvg7E/hDaXAiCgruukNKm4BUPVGXeyXaFWlw6/BX5FYYONk9wTugwL0qqqktKvuBAGH1K5JEX3oJiqz+q5JjAV93ssnHfROXfMIX0c4PLdzvkwAjFoyiPhPM8RWGVMYEG0yLgQINhkjADsIYYH8mquJU/hICE51lCGRA4zfQJxTw0s/ObjKmRQsGSLhLIskwKqoH/GY5dxH87u94Z3yhLOXXxLfiT0bi8pEQvgszl8s7Bf57MwPs/hFI4Hr25P7Ok39Ub4D2J5aL3E0xoNAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='runner-registration.png' title='' src='/static/6fedd99483492e0a4fda63fa9cc0365f/ca1dc/runner-registration.png' srcset='/static/6fedd99483492e0a4fda63fa9cc0365f/e7570/runner-registration.png 170w,\n/static/6fedd99483492e0a4fda63fa9cc0365f/f46e7/runner-registration.png 340w,\n/static/6fedd99483492e0a4fda63fa9cc0365f/ca1dc/runner-registration.png 680w,\n/static/6fedd99483492e0a4fda63fa9cc0365f/911ab/runner-registration.png 710w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>runner-registration.png</figcaption>\n  </figure></p>\n<p>위 이미지처럼 name, 추가 label을 지정하고 설치한 runner를 확인하면, 다음과 같이 <code class=\"language-text\">dev</code> 라벨이 추가된 것을 확인할 수 있습니다.\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/d42a5c2af740caa6234742b088b86f9e/9f1c6/runner-label.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 29.411764705882355%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA8klEQVR42oVQy0oEMRDM/8P+gHr2Nxb1sOhFEPayIgvjg2F1Hnn0ZJJJpuzOqCy4aENRXZ1KdyfKWouqqtC2LSTmecZ/8e1ZP22wur7A2e0lVlfnuH/dQrnBoz40aDoN4wYYSyAiuCPQMGBgHxGz96XmWe/e9rjZ3WGz32L9+IDaNFAUEt5NxEFH1N2IxoyIcfqFaRKOX7zkOWVeVzZeIKEmLhpHCGxKnMcpMfIC1oF1iKfhQ0RvXfGMnEsvNY4B1fMLOm3Q9aY8WRvH7Iom8rxVKsNO4aNp0ff6x6Pkg+UZOecyIaXjy6nU/4rE5+KRPoJPfd3QMifHA3wAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='runner-label.png' title='' src='/static/d42a5c2af740caa6234742b088b86f9e/ca1dc/runner-label.png' srcset='/static/d42a5c2af740caa6234742b088b86f9e/e7570/runner-label.png 170w,\n/static/d42a5c2af740caa6234742b088b86f9e/f46e7/runner-label.png 340w,\n/static/d42a5c2af740caa6234742b088b86f9e/ca1dc/runner-label.png 680w,\n/static/d42a5c2af740caa6234742b088b86f9e/9f1c6/runner-label.png 828w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>runner-label.png</figcaption>\n  </figure></p>\n<blockquote>\n<p>⚠️ 개인 로컬에서 테스트로 만든 예시 이미지로, 실제 서비스의 운영 환경과는 상이합니다.</p>\n</blockquote>\n<p>더 빠른 설정을 원한다면, 아래와 같이 <code class=\"language-text\">./config.sh</code> 실행 시 원하는 값들을 바로 전달해줘도 됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ ./config.sh <span class=\"token parameter variable\">--url</span> <span class=\"token variable\">${repository URL}</span> <span class=\"token parameter variable\">--token</span> <span class=\"token variable\">${runner 생성 페이지에서 제공된 토큰}</span> <span class=\"token parameter variable\">--name</span> <span class=\"token builtin class-name\">test</span> <span class=\"token parameter variable\">--labels</span> dev</code></pre></div>\n<blockquote>\n<p><strong>label을 왜 추가했을까요?</strong><br>\n각 Runner를 구분할 수 있는 label을 지정해서 <code class=\"language-text\">runs-on</code> 블록에서 어떤 Runner에게 일을 시킬지 명시하기 위함입니다.<br>\n괜찮을지도 팀은 한 리포지토리에서 운영 서버, 개발 서버에 각각 띄울 두 개의 Runner를 사용하기 때문에\n이를 구분하기 위한 <code class=\"language-text\">dev</code>, <code class=\"language-text\">prod</code> label을 지정하였습니다.<br>\n아래는 <code class=\"language-text\">dev</code>, <code class=\"language-text\">self-hosted</code> 라벨을 가진 runner를 지정하는 예시입니다.</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span> self<span class=\"token punctuation\">-</span>hosted<span class=\"token punctuation\">,</span> dev <span class=\"token punctuation\">]</span></code></pre></div>\n<blockquote>\n<p><strong>이미 생성한 Runner에 label을 추가하려면?</strong><br>\nGitHub 공식문서에 따르면, 2023년 2월부터 GUI로 label을 추가하는 기능을 제공하지 않는다고 합니다.<br>\nconfig.sh 파일을 수정해 설정할 수도 없습니다.<br>\n대신 GitHub에서 제공하는 \"Self-hosted runners\" REST API를 사용해 추가해주어야 합니다.</p>\n</blockquote>\n<h4>3. Runner 실행</h4>\n<p>   Runner 설정이 완료되었다면, 아래 명령어로 Runner를 실행합니다.<br>\n레포지토리의 <code class=\"language-text\">Settings</code> - <code class=\"language-text\">Actions</code> - <code class=\"language-text\">Runners</code> 페이지에서 Status가 <code class=\"language-text\">idle</code>로 바뀌었다면 정상적으로 실행된 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">$ ./run.sh</code></pre></div>\n<p>참고로 서버 내 저장한 환경변수를 업데이트 했을 때에는, Runner도 재시작하기를 잊지 마세요!<br>\n왜일까요? 자세한 내용은<br>\n<a href=\"https://map-befine-official.github.io/trouble-shooting-actions-runner\">EC2 환경 변수 적용 및 Actions Runner에 환경 변수 적용이 안되는 이슈</a>에서 확인하실 수 있습니다.</p>\n<h2>참고 자료</h2>\n<p><a href=\"https://docs.github.com/ko/actions/using-workflows/about-workflows\">https://docs.github.com/ko/actions/using-workflows/about-workflows</a><br>\n<a href=\"https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/about-self-hosted-runners\">https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/about-self-hosted-runners</a><br>\n<a href=\"https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/using-labels-with-self-hosted-runners\">https://docs.github.com/en/actions/hosting-your-own-runners/managing-self-hosted-runners/using-labels-with-self-hosted-runners</a>  </p>","frontmatter":{"title":"GitHub Actions로 CI/CD 구축하기","date":"July 29, 2023","update":"August 09, 2023","tags":["인프라"],"series":null},"fields":{"slug":"/github-actions-ci-cd/","readingTime":{"minutes":15.29}}},"seriesList":{"edges":[{"node":{"id":"9e6463d2-18de-5fdf-b4e6-8707709710e1","fields":{"slug":"/how-to-write-a-post/"},"frontmatter":{"title":"포스트 작성 방법"}}},{"node":{"id":"b802f2fe-d332-504c-be84-fd7aa170c622","fields":{"slug":"/github-actions-ci-cd/"},"frontmatter":{"title":"GitHub Actions로 CI/CD 구축하기"}}},{"node":{"id":"45b7dc00-ae71-58e4-9dc2-7aff92f0ca0d","fields":{"slug":"/trouble-shooting-actions-runner/"},"frontmatter":{"title":"EC2 환경 변수 적용 및 Actions Runner에 환경 변수 적용이 안되는 이슈"}}},{"node":{"id":"cb221d09-1977-59c9-9bc3-cd607a15d292","fields":{"slug":"/how-to-isolating-test/"},"frontmatter":{"title":"인수테스트에서 테스트 격리하기!"}}},{"node":{"id":"fa602b8b-64fa-59b0-b377-089612f91d9f","fields":{"slug":"/how-to-use-nginx/"},"frontmatter":{"title":"괜찮을지도의 Nginx 활용법"}}},{"node":{"id":"89dc33ed-1ad0-5d79-8148-b1a16f417a71","fields":{"slug":"/trouble-shooting-modifying-annotation/"},"frontmatter":{"title":"@Modifying 어노테이션의 옵션이 정상 동작하지 않는 문제"}}},{"node":{"id":"db91695e-5bf6-554c-bafd-e161d686fadf","fields":{"slug":"/trouble-shooting-fetch-type/"},"frontmatter":{"title":"FetchType.EAGER, FetchType.LAZY 에 대해서 알아보자!"}}},{"node":{"id":"2b3c31ce-d59e-50a0-92b2-7dc228aacf29","fields":{"slug":"/jpa-multibag-fetch-exception/"},"frontmatter":{"title":"Fetch join 사용 시 MultipleBagFetchException의 발생 이유와 해결 방법"}}},{"node":{"id":"253d110b-e241-549e-923a-f26782aab2dc","fields":{"slug":"/how-to-hikariCP/"},"frontmatter":{"title":"HikariCP 적용기"}}}]},"previous":{"fields":{"slug":"/how-to-write-a-post/"},"frontmatter":{"title":"포스트 작성 방법"}},"next":{"fields":{"slug":"/trouble-shooting-actions-runner/"},"frontmatter":{"title":"EC2 환경 변수 적용 및 Actions Runner에 환경 변수 적용이 안되는 이슈"}}},"pageContext":{"id":"b802f2fe-d332-504c-be84-fd7aa170c622","series":null,"previousPostId":"9e6463d2-18de-5fdf-b4e6-8707709710e1","nextPostId":"45b7dc00-ae71-58e4-9dc2-7aff92f0ca0d"}},"staticQueryHashes":[],"slicesMap":{}}